"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4010],{44010:function(n,t,e){e.d(t,{Nf:function(){return w},Sx:function(){return P},xI:function(){return I}});var r=e(47568),u=e(41799),i=e(69396),o=e(828),a=e(70655),s=e(85893),c=e(67294),l=e(73545),d=e(57822),p=e(11037),f=e(41559),v=e(98582),z=e(97805),h=e(10025),b=e(55765),y=function(){var n=(0,r.Z)((function(n,t){var e,r;return(0,a.__generator)(this,(function(u){switch(u.label){case 0:return e=t.uid,r=[(0,b.e9)({uid:e}),void 0],[4,(0,v.U)(n)];case 1:return[4,z.Yu.apply(void 0,r.concat(u.sent()))];case 2:return[2,v.Z.apply(void 0,[u.sent(),h.$o])]}}))}));return function(t,e){return n.apply(this,arguments)}}(),g=function(){var n=(0,r.Z)((function(n,t){var e,r,u;return(0,a.__generator)(this,(function(i){switch(i.label){case 0:return e=t.uid,r=t.modules,u=[(0,b.e9)({uid:e}),{modules:r}],[4,(0,v.U)(n)];case 1:return[4,z.qC.apply(void 0,u.concat(i.sent()))];case 2:return[2,v.Z.apply(void 0,[i.sent(),h.On])]}}))}));return function(t,e){return n.apply(this,arguments)}}(),m=e(1604),Z=m.z.object({deployed:m.z.object({accountId:m.z.string(),napkinId:m.z.string()})}),_=function(){var n=(0,r.Z)((function(n,t){var e,r,u,i;return(0,a.__generator)(this,(function(o){switch(o.label){case 0:return e=t.accountId,r=t.napkinId,u=t.request,i=["".concat("https://api.napkin.io","/v1/deploy"),{accountId:e,napkinId:r,request:u}],[4,(0,v.U)(n)];case 1:return[4,z.qC.apply(void 0,i.concat(o.sent()))];case 2:return[2,v.Z.apply(void 0,[o.sent(),Z])]}}))}));return function(t,e){return n.apply(this,arguments)}}(),j=m.z.object({body:m.z.string().nullable(),headers:m.z.record(m.z.string()),logs:m.z.array(m.z.object({ioStream:m.z.literal("stdout").or(m.z.literal("stderr")),message:m.z.string(),napkinUid:m.z.string(),timeSinceEpoch:m.z.number(),timestamp:m.z.string()})),returnValue:m.z.number(),statusCode:m.z.number(),status_code:m.z.number()}),k=function(){var n=(0,r.Z)((function(n,t){var e,r,u,i;return(0,a.__generator)(this,(function(o){switch(o.label){case 0:return e=t.accountId,r=t.napkinId,u=t.request,i=["".concat("https://api.napkin.io","/v1/test"),{accountId:e,napkinId:r,request:u}],[4,(0,v.U)(n)];case 1:return[4,z.qC.apply(void 0,i.concat(o.sent()))];case 2:return[2,v.Z.apply(void 0,[o.sent(),j])]}}))}));return function(t,e){return n.apply(this,arguments)}}(),S=e(64487),w=(0,c.createContext)(null),I=function(){return(0,c.useContext)(w)},O=function(n){try{var t=JSON.parse(n);if(t&&"object"===typeof t)return t}catch(e){return{error:"Invalid JSON"}}return{error:"Invalid JSON"}},P=function(n){var t=n.children,e=n.data,v=(0,p.cF)(),z=v.workspaceData,h=v.currentUser,b=(0,c.useState)(!1),m=b[0],Z=b[1],j=(0,c.useState)({}),I=j[0],P=j[1],x=(0,c.useState)({userEndpoint:"",userPathURI:"",userPathParams:[],codeItems:[{value:"Code"},{value:"Modules"},{value:"Events"},{value:"Other"}],codeItem:"Code",savingCode:!1,requestOptions:!1,requestMethod:"GET",responseOutput:null,testBodyText:void 0,testBodyJSON:"{}",logs:!1,pressDeploy:!1,statusDot:"notDeployed",settings:null,showDeploy:!0,showOutputPanel:!1,modules:{},deployLoading:!1,showMissingPathParams:!1}),N=x[0],E=x[1],q=(0,c.useRef)();q.current=N;var C=(0,c.useState)({installed:{},error:null,loading:!1,initialLoad:!0}),T=C[0],U=C[1],D=(0,o.Z)((0,l.ZP)("bodyState","Text"),2),B=D[0],J=D[1],M=(0,d.Z)().setToast;(0,c.useEffect)((function(){if(m){var n=(null===z||void 0===z?void 0:z.domain)||"".concat((null===I||void 0===I?void 0:I.workspaceName)||(null===z||void 0===z?void 0:z.name),".").concat("","npkn.net");L({userEndpoint:"https://".concat(n,"/").concat(I.name)})}}),[m]),(0,c.useEffect)((function(){var n=function(){var n=(0,r.Z)((function(){var n;return(0,a.__generator)(this,(function(t){switch(t.label){case 0:if(!h)return[2];if(!e.uid)throw"Data object missing";return[4,(0,f.z)(h,{uid:e.uid})];case 1:return n=t.sent(),P(n.napkin),Z(!0),[2]}}))}));return function(){return n.apply(this,arguments)}}();n().catch(console.error)}),[h]),(0,c.useEffect)((function(){function n(){return(n=(0,r.Z)((function(){var n,t;return(0,a.__generator)(this,(function(e){switch(e.label){case 0:return(null===I||void 0===I?void 0:I.uid)?(U((function(n){return(0,i.Z)((0,u.Z)({},n),{loading:!0})})),[4,R()]):[2];case 1:return n=e.sent(),L({modules:n||{}}),t=n||{},U((function(n){return(0,i.Z)((0,u.Z)({},n),{installed:t,loading:!1})})),[2]}}))}))).apply(this,arguments)}h&&0===Object.keys(N.modules).length&&function(){n.apply(this,arguments)}()}),[h,I]);var L=function(n){E((function(t){return(0,u.Z)({},t,n)}))},G=function(n){return{accountId:n.uid,napkinId:I.uid,request:{method:N.requestMethod||"GET",data:"Text"===B&&N.testBodyText,json:"JSON"===B&&O(N.testBodyJSON)}}},Y=function(){var n=(0,r.Z)((function(){var n,t,e,r,o,s,c,l,d,p,f;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:if(!h)return[2];s=null===(n=q.current)||void 0===n?void 0:n.userPathParams.filter((function(n){return!(null===n||void 0===n?void 0:n.value)})).length,E((function(n){return(0,i.Z)((0,u.Z)({},n),{showOutputPanel:!0,codeItem:"Code",responseOutput:{},showMissingPathParams:Boolean(s)})})),c=null===(t=q.current)||void 0===t?void 0:t.userPathParams,l=Object.fromEntries((null!==c&&void 0!==c?c:[]).map((function(n){return[n.key.replace(/[{}]/g,""),n.value]}))),d={accountId:null===h||void 0===h?void 0:h.uid,napkinId:null===I||void 0===I?void 0:I.uid,request:{method:(null===(e=q.current)||void 0===e?void 0:e.requestMethod)||"GET",path_params:l,data:"Text"===B?null===(r=q.current)||void 0===r?void 0:r.testBodyText:null,json:"JSON"===B?O((null===(o=q.current)||void 0===o?void 0:o.testBodyJSON)||""):null}},a.label=1;case 1:return a.trys.push([1,3,,4]),[4,k(h,d)];case 2:return p=a.sent(),E((function(n){return(0,i.Z)((0,u.Z)({},n),{codeItem:"Code",showOutputPanel:!0,responseOutput:p})})),[3,4];case 3:return f=a.sent(),S.Tb(f),console.log(f),L({responseOutput:{error:"An error occured when running your function. Please try again."}}),[3,4];case 4:return[2]}}))}));return function(){return n.apply(this,arguments)}}();function $(){return $=(0,r.Z)((function(){return(0,a.__generator)(this,(function(n){return h?"isDeployed"!==N.statusDot?(L({deployLoading:!0}),[2,new Promise(function(){var n=(0,r.Z)((function(n,t){var e,r;return(0,a.__generator)(this,(function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),[4,_(h,G(h))];case 1:return(null===(e=u.sent())||void 0===e?void 0:e.deployed)?(L({pressDeploy:!0,deployLoading:!1,statusDot:"isDeployed"}),n(e)):L({deployLoading:!1}),[3,3];case 2:return r=u.sent(),S.Tb(r),console.error(r),L({deployLoading:!1}),t(r),[3,3];case 3:return[2]}}))}));return function(t,e){return n.apply(this,arguments)}}())]):(M({text:"Update your code to deploy again!",type:"success"}),[2]):[2]}))})),$.apply(this,arguments)}var A=function(){var n=(0,r.Z)((function(n){var t,e,r,o,s,c,l;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:if(!h)return[2];t=T.installed,e=null,r=(0,u.Z)({},t),o=null,U((function(n){return(0,i.Z)((0,u.Z)({},n),{loading:!0,initialLoad:!1})})),n.add||n.update?(s=n.add||n.update,r[s.id]=s.version):delete r[n.remove.id],c=null,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,g(h,{uid:I.uid,modules:r})];case 2:return c=a.sent(),[3,4];case 3:return l=a.sent(),S.Tb(l),o=l,[3,4];case 4:return c&&c.success?e=c.modules:c&&(o=c.error||o),U((function(n){return(0,i.Z)((0,u.Z)({},n),{installed:null!==e&&void 0!==e?e:t,loading:!1,error:o})})),[2]}}))}));return function(t){return n.apply(this,arguments)}}(),R=function(){var n=(0,r.Z)((function(){var n,t;return(0,a.__generator)(this,(function(e){switch(e.label){case 0:if(!h)return[2];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,y(h,{uid:I.uid})];case 2:return[2,(null===(n=e.sent())||void 0===n?void 0:n.modules)||{}];case 3:return t=e.sent(),S.Tb(t),console.log(t),[3,4];case 4:return[2]}}))}));return function(){return n.apply(this,arguments)}}(),F={dataLoaded:m,user:h,napkinState:I,editorState:N,runNapkin:Y,deploy:function(){return $.apply(this,arguments)},modulesState:T,syncModules:A,setModulesState:U,updateEditorState:L,updateNapkinState:function(n){P((function(t){return(0,u.Z)({},t,n)}))},localStorageStates:{bodyState:B,setBodyState:J}};return(0,s.jsx)(w.Provider,{value:F,children:t})}},41559:function(n,t,e){e.d(t,{z:function(){return c}});var r=e(47568),u=e(70655),i=e(55765),o=e(97805),a=e(10025),s=e(98582),c=function(){var n=(0,r.Z)((function(n,t){var e,r;return(0,u.__generator)(this,(function(u){switch(u.label){case 0:return e=t.uid,r=[(0,i.u$)({uid:e}),void 0],[4,(0,s.U)(n)];case 1:return[4,o.Yu.apply(void 0,r.concat(u.sent()))];case 2:return[2,s.Z.apply(void 0,[u.sent(),a.Ob])]}}))}));return function(t,e){return n.apply(this,arguments)}}()},10025:function(n,t,e){e.d(t,{$o:function(){return _},KQ:function(){return O},Ob:function(){return z},On:function(){return Z},SY:function(){return I},VP:function(){return b},jc:function(){return h},o3:function(){return v},og:function(){return w}});var r=e(78991),u=e(1604),i=u.z.object({runtime:u.z.literal("python3.8"),pythonRequirements:u.z.array(u.z.object({distribution:u.z.string(),locked:u.z.boolean(),name:u.z.string(),transitive:u.z.boolean(),version:u.z.string(),top_level_names:u.z.array(u.z.string())})).nullable()}),o=u.z.object({runtime:u.z.literal("nodejs14.x"),codeStrCompiled:u.z.string().nullable(),codeStrTestCompiled:u.z.string().nullable(),compileError:u.z.string().nullable(),nodeModules:u.z.record(u.z.string()).nullable()}),a=u.z.object({workspaceName:u.z.string(),workspace_id:u.z.string(),workspace_type:r.QS}),s=u.z.object({accountName:u.z.string(),accountId:u.z.string().nullable().optional()}),c=u.z.object({name:u.z.string(),uid:u.z.string(),lastEdited:u.z.string().or(u.z.number()),lastEditedBy:u.z.string().nullable(),deleted:u.z.boolean(),description:u.z.string().nullable(),domain:u.z.string().nullable(),env_vars:u.z.array(u.z.string()).optional(),path:u.z.string(),readme:u.z.string().nullable(),requireAuth:u.z.boolean(),timeCreated:u.z.number(),version:u.z.string(),visibility:r.eF,displayName:u.z.string().optional(),tags:u.z.array(u.z.string()).optional()}),l=u.z.object({codeStr:u.z.string(),codeStrTest:u.z.string().nullable().optional()}),d=c.extend(s.shape).extend(a.shape).extend(l.shape),p=o.extend(d.shape),f=i.extend(d.shape),v=u.z.discriminatedUnion("runtime",[p,f]),z=u.z.object({napkin:v}),h=u.z.object({updated:u.z.object({requireAuth:u.z.boolean().optional()})}),b=u.z.discriminatedUnion("visibility",[u.z.object({visibility:u.z.literal("private")}),u.z.object({visibility:u.z.literal("public"),publicUrl:u.z.string()})]),y=u.z.record(u.z.string()),g=u.z.object({success:u.z.literal(!0),modules:y}),m=u.z.object({success:u.z.literal(!1),error:u.z.any()}),Z=u.z.discriminatedUnion("success",[g,m]),_=u.z.object({modules:y}),j=u.z.union([u.z.literal("*"),u.z.array(u.z.number()),u.z.number(),u.z.undefined()]),k=u.z.object({hours:j,minutes:j}),S=u.z.object({success:u.z.boolean(),failure:u.z.boolean()}),w=u.z.object({enabled:u.z.coerce.boolean(),schedule:k.optional(),notifications:S.optional()}),I=u.z.object({cloned:v}),O=u.z.discriminatedUnion("success",[u.z.object({success:u.z.literal(!0),name:u.z.string()}),u.z.object({success:u.z.literal(!1),message:u.z.string()})])},55765:function(n,t,e){e.d(t,{GB:function(){return h},Jc:function(){return a},NW:function(){return d},Wv:function(){return v},e9:function(){return s},n0:function(){return c},nl:function(){return z},pY:function(){return f},pr:function(){return p},tv:function(){return l},u$:function(){return o}});var r=e(34078),u=e.n(r),i="".concat("https://api.napkin.io","/v1/napkin"),o=function(n){var t=n.uid;return u()(i,t)},a=function(){return u()(i,"visibility")},s=function(n){var t=n.uid;return u()(o({uid:t}),"modules")},c=function(n){var t=n.uid;return u()(o({uid:t}),"name")},l=function(n){var t=n.uid;return u()(o({uid:t}),"readme")},d=function(n){var t=n.uid;return u()(o({uid:t}),"description")},p=function(n){var t=n.uid;return u()(o({uid:t}),"schedule")},f=function(n){var t=n.uid;return u()(p({uid:t}),"disable")},v=function(){return"".concat("https://api.napkin.io","/v2/new")},z=function(){return"".concat("https://api.napkin.io","/v1/clone")},h=function(){return"".concat("https://api.napkin.io","/v1/checkpoint")}}}]);